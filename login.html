<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Clothing Store Inventory</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Login Page -->
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>Clothing Store Inventory</h1>
                <p>Sign in to your account</p>
            </div>
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="loginEmail" class="form-label">Email</label>
                    <input type="email" id="loginEmail" class="form-control" required placeholder="Try: admin@clothingstore.com" value="admin@clothingstore.com">
                </div>
                <div class="form-group">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" id="loginPassword" class="form-control" required placeholder="Try: admin123" value="admin123">
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="rememberMe">
                        Remember me
                    </label>
                </div>
                <button type="submit" class="btn btn--primary btn--full-width">Sign In</button>
                <p class="auth-switch">
                    Don't have an account? 
                    <a href="register.html">Register here</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="app.js"></script>
    <script>
        // Initialize login page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ðŸ” Login Page Loaded');
            
            // Handle login form submission
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('loginEmail').value.trim().toLowerCase();
                const password = document.getElementById('loginPassword').value;
                
                // Clear any existing error messages
                const existingError = document.querySelector('.auth-error');
                if (existingError) {
                    existingError.remove();
                }
                
                // Validation
                if (!email || !password) {
                    showAuthError('Please enter both email and password');
                    return;
                }
                
                // Show loading state
                const submitBtn = e.target.querySelector('button[type="submit"]');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'Signing In...';
                submitBtn.disabled = true;
                
                // Simulate authentication
                setTimeout(() => {
                    // Check credentials against sample users
                    const users = [
                        { id: 1, name: "Store Admin", email: "admin@clothingstore.com", role: "Admin", password: "admin123", active: true },
                        { id: 2, name: "Store Manager", email: "manager@clothingstore.com", role: "Manager", password: "manager123", active: true },
                        { id: 3, name: "Sales Staff", email: "staff@clothingstore.com", role: "Staff", password: "staff123", active: true }
                    ];
                    
                    console.log('Login attempt:', { email, password });
                    const user = users.find(u => u.email === email && u.password === password);
                    console.log('Found user:', user);
                    
                    if (user && user.active) {
                        // Store user session
                        sessionStorage.setItem('currentUser', JSON.stringify(user));
                        sessionStorage.setItem('loginTime', Date.now().toString());
                        
                        // Show success message
                        showToast(`Welcome back, ${user.name}!`, 'success');
                        
                        // Redirect to dashboard
                        setTimeout(() => {
                            window.location.href = 'dashboard.html';
                        }, 1000);
                    } else if (user && !user.active) {
                        showAuthError('Your account has been deactivated. Please contact administrator.');
                        submitBtn.textContent = originalText;
                        submitBtn.disabled = false;
                    } else {
                        showAuthError('Invalid email or password. Please check your credentials and try again.');
                        submitBtn.textContent = originalText;
                        submitBtn.disabled = false;
                    }
                }, 800);
            });
        });

        function showAuthError(message) {
            // Remove existing error
            const existingError = document.querySelector('.auth-error');
            if (existingError) {
                existingError.remove();
            }
            
            // Create error element
            const errorDiv = document.createElement('div');
            errorDiv.className = 'auth-error';
            errorDiv.style.cssText = `
                background-color: rgba(var(--color-error-rgb), 0.1);
                color: var(--color-error);
                padding: var(--space-12);
                border-radius: var(--radius-base);
                border: 1px solid rgba(var(--color-error-rgb), 0.3);
                margin-bottom: var(--space-16);
                font-size: var(--font-size-sm);
                text-align: center;
            `;
            errorDiv.textContent = message;
            
            // Insert before form
            const form = document.querySelector('.auth-form');
            if (form) {
                form.insertBefore(errorDiv, form.firstChild);
            }
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'times-circle' : 'exclamation-circle'}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    </script>
</body>
</html>